<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <!-- Ensures correct scaling on mobile -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
    <title>AR Business Card</title>

    <!-- A-Frame core library -->
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    
    <!-- MindAR for A-Frame (image tracking) -->
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>

    <!-- Force-hide any VR/AR buttons that might appear -->
    <style>
      html, body {
        margin: 0; 
        padding: 0; 
        overflow: hidden;
      }
      button.a-enter-vr, 
      .a-enter-vr-button, 
      .a-enter-ar-button, 
      .a-enter-ar, 
      .a-enter-vr {
        display: none !important;
      }
    </style>
  </head>
  <body>
    <!-- Full-screen scene with MindAR image tracking -->
    <a-scene
      style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;"
      mindar-image="imageTargetSrc: ./targets.mind; autoStart: true;"
      vr-mode-ui="enabled: false"
      device-orientation-permission-ui="enabled: false"
    >
      <!-- 1) ASSETS: Preload your .webp icons -->
      <a-assets>
        <!-- Update these paths to match your folder structure -->
        <img id="iconFB" src="./icons/facebook.webp" />
        <img id="iconIG" src="./icons/instagram.webp" />
        <img id="iconLN" src="./icons/linkedin.webp" />
      </a-assets>

      <!-- 2) CAMERA + CURSOR -->
      <!-- The cursor allows tap/click events on 3D objects -->
      <a-camera position="0 0 0" look-controls="enabled: false">
        <a-entity 
          cursor="rayOrigin: mouse; fuse: false;" 
          raycaster="objects: .clickable"
          position="0 0 -1"
        ></a-entity>
      </a-camera>

      <!-- 3) AR CONTENT: anchored to your business card marker (targetIndex: 0) -->
      <a-entity mindar-image-target="targetIndex: 0">
        <!-- Social icons at bottom of the card (negative Y) -->
        <a-image
          id="fbIcon"
          class="clickable"
          src="#iconFB"
          position="-0.3 -0.5 0"
          scale="0.25 0.25 0.25"
        ></a-image>

        <a-image
          id="igIcon"
          class="clickable"
          src="#iconIG"
          position="0 -0.5 0"
          scale="0.25 0.25 0.25"
        ></a-image>

        <a-image
          id="lnIcon"
          class="clickable"
          src="#iconLN"
          position="0.3 -0.5 0"
          scale="0.25 0.25 0.25"
        ></a-image>
      </a-entity>
    </a-scene>

    <!-- 4) JS: handle tap/click events and open links -->
    <script>
      // Helper function to open a URL in a new tab (or same tab)
      function openLink(url) {
        window.open(url, '_blank');
      }

      document.addEventListener('DOMContentLoaded', () => {
        const fbIcon = document.querySelector('#fbIcon');
        const igIcon = document.querySelector('#igIcon');
        const lnIcon = document.querySelector('#lnIcon');

        // Add both 'mousedown' and 'touchstart' to ensure mobile compatibility
        fbIcon.addEventListener('mousedown', () => openLink('https://www.facebook.com/login'));
        fbIcon.addEventListener('touchstart', () => openLink('https://www.facebook.com/login'));

        igIcon.addEventListener('mousedown', () => openLink('https://www.instagram.com/accounts/login'));
        igIcon.addEventListener('touchstart', () => openLink('https://www.instagram.com/accounts/login'));

        lnIcon.addEventListener('mousedown', () => openLink('https://www.linkedin.com/login'));
        lnIcon.addEventListener('touchstart', () => openLink('https://www.linkedin.com/login'));
      });
    </script>
  </body>
</html>
